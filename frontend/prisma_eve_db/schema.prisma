generator client {
  provider = "prisma-client"
  output   = "./eve_db"
}

datasource db {
  provider = "sqlite"
  url      = env("EVE_DB_URL")
}

model alert {
  id         Int     @id @default(autoincrement())
  flow_id    Int
  timestamp  Int
  extra_data String?

  @@index([flow_id])
}

model anomaly {
  id         Int     @id @default(autoincrement())
  flow_id    Int
  timestamp  Int
  extra_data String?

  @@unique([flow_id, timestamp], map: "sqlite_autoindex_anomaly_1")
  @@index([flow_id])
}

model app_event {
  id         Int     @id @default(autoincrement())
  flow_id    Int
  timestamp  Int
  app_proto  String
  extra_data String?

  @@unique([flow_id, app_proto, timestamp], map: "sqlite_autoindex_app-event_1")
  @@index([flow_id])
  @@map("app-event")
}

model fileinfo {
  id         Int     @id @default(autoincrement())
  flow_id    Int
  timestamp  Int
  extra_data String?

  @@unique([flow_id, timestamp], map: "sqlite_autoindex_fileinfo_1")
  @@index([flow_id])
}

model flow {
  id            Int     @id @default(autoincrement())
  src_ip        String
  src_port      Int?
  dest_ip       String
  dest_port     Int?
  pcap_filename String?
  proto         String
  app_proto     String?
  metadata      String?
  extra_data    String?

  @@index([app_proto])
}
